{"version":3,"sources":["../src/errors.ts"],"sourcesContent":["import { hasOwnProperty } from './collections';\nimport { truncate } from './strings';\n\ndeclare global {\n  interface Error {\n    code?: unknown;\n  }\n}\n\nexport type PlainObject = Record<string, unknown>;\n\nexport interface SerializedError extends PlainObject {\n  message: string;\n  name: string;\n  stack?: string;\n  code?: unknown;\n}\n\nexport function serializeError(error: Error): SerializedError {\n  const { message, name, stack, code } = error;\n  return { message, name, stack, code };\n}\n\n/**\n * Creates a javascript `Error` from an unknown value if it's not already an error.\n * Does a best effort at inferring a message. Intended to be used typically in `catch`\n * blocks, as there is no way to enforce only `Error` objects being thrown.\n *\n * ```\n * try {\n *   // ...\n * } catch (rawError) {\n *   const error = errorFrom(rawError);\n *   console.assert(error instanceof Error);\n * }\n * ```\n */\nexport function errorFrom(maybeError: unknown): Error {\n  if (maybeError instanceof Error) {\n    return maybeError;\n  }\n\n  if (\n    typeof maybeError === 'object' &&\n    maybeError &&\n    hasOwnProperty(maybeError, 'message') &&\n    typeof maybeError.message === 'string'\n  ) {\n    return new Error(maybeError.message, { cause: maybeError });\n  }\n\n  if (typeof maybeError === 'string') {\n    return new Error(maybeError, { cause: maybeError });\n  }\n\n  const message = truncate(String(JSON.stringify(maybeError)), 500);\n  return new Error(message, { cause: maybeError });\n}\n"],"mappings":";;;;;;;;AAkBO,SAAS,eAAe,OAA+B;AAC5D,QAAM,EAAE,SAAS,MAAM,OAAO,KAAK,IAAI;AACvC,SAAO,EAAE,SAAS,MAAM,OAAO,KAAK;AACtC;AAgBO,SAAS,UAAU,YAA4B;AACpD,MAAI,sBAAsB,OAAO;AAC/B,WAAO;AAAA,EACT;AAEA,MACE,OAAO,eAAe,YACtB,cACA,eAAe,YAAY,SAAS,KACpC,OAAO,WAAW,YAAY,UAC9B;AACA,WAAO,IAAI,MAAM,WAAW,SAAS,EAAE,OAAO,WAAW,CAAC;AAAA,EAC5D;AAEA,MAAI,OAAO,eAAe,UAAU;AAClC,WAAO,IAAI,MAAM,YAAY,EAAE,OAAO,WAAW,CAAC;AAAA,EACpD;AAEA,QAAM,UAAU,SAAS,OAAO,KAAK,UAAU,UAAU,CAAC,GAAG,GAAG;AAChE,SAAO,IAAI,MAAM,SAAS,EAAE,OAAO,WAAW,CAAC;AACjD;","names":[]}